var jssort=jssort||{};!function(jss){var NormalDistribution=function(t,i){t||(t=0),i||(i=1),this.mean=t,this.sd=i,this.Sqrt2=1.4142135623730951,this.Sqrt2PI=2.5066282746310007,this.lnconstant=-Math.log(this.Sqrt2PI*i)};NormalDistribution.prototype.sample=function(){},NormalDistribution.prototype.cumulativeProbability=function(t){var i=(t-this.mean)/(this.Sqrt2*this.sd);return.5+.5*this.errorFunc(i)},NormalDistribution.prototype.invCumulativeProbability=function(t){return this.Sqrt2*this.invErrorFunc(2*t-1)*this.sd+this.mean},NormalDistribution.prototype.errorFunc=function(t){var i=1/(1+.5*Math.abs(t)),r=1-i*Math.exp(-t*t-1.26551223+i*(1.00002368+i*(.37409196+i*(.09678418+i*(i*(.27886807+i*(i*(1.48851587+i*(.17087277*i-.82215223))-1.13520398))-.18628806)))));return t>=0?r:-r},NormalDistribution.prototype.invErrorFunc=function(t){var i,r;if(r=0==t?0:t>0?1:-1,0!=t){var o=Math.log(1-t*t),a=o/.147,s=o/2+2/(.147*Math.PI),e=Math.sqrt(s*s-a);i=Math.sqrt(e-s)*r}else i=0;return i},jss.NormalDistribution=NormalDistribution;var TDistribution=function(t){t&&(this.df=t)};TDistribution.prototype.LogGamma=function(Z){with(Math)var S=1+76.18009173/Z-86.50532033/(Z+1)+24.01409822/(Z+2)-1.231739516/(Z+3)+.00120858003/(Z+4)-536382e-11/(Z+5),LG=(Z-.5)*log(Z+4.5)-(Z+4.5)+log(2.50662827465*S);return LG},TDistribution.prototype.Betinc=function(t,i,r){for(var o,a=0,s=1,e=1,n=1,u=0,h=0;Math.abs((e-h)/e)>1e-5;)h=e,s=n+(o=-(i+u)*(i+r+u)*t/(i+2*u)/(i+2*u+1))*s,e=(a=e+o*a)+(o=(u+=1)*(r-u)*t/(i+2*u-1)/(i+2*u))*e,a/=n=s+o*n,s/=n,e/=n,n=1;return e/i},TDistribution.prototype.cumulativeProbability=function(X,df){with(df||(df=this.df),Math)df<=0?console.error("Degrees of freedom must be positive"):(A=df/2,S=A+.5,Z=df/(df+X*X),BT=exp(this.LogGamma(S)-this.LogGamma(.5)-this.LogGamma(A)+A*log(Z)+.5*log(1-Z)),Z<(A+1)/(S+2)?betacdf=BT*this.Betinc(Z,A,.5):betacdf=1-BT*this.Betinc(1-Z,.5,A),tcdf=X<0?betacdf/2:1-betacdf/2),tcdf=round(1e5*tcdf)/1e5;return tcdf},TDistribution.prototype.invCumulativeProbability=function(t,i){i||(i=this.df);if(t>=.5){s=0;for(o=0;o<100&&!(this.cumulativeProbability(o,i)>=t);o++)s=o;for(var r=s,o=0;o<100&&!(this.cumulativeProbability(s+o/100)>=t);o+=1)r=s+o/100;for(var a=r,o=0;o<100&&!(this.cumulativeProbability(r+o/1e4)>=t);o+=1)a=r+o/1e4;return a}for(var s=0,o=0;o<100&&!(this.cumulativeProbability(-o,i)<=t);o++)s=o;for(var r=s,o=0;o<100&&!(this.cumulativeProbability(-s-o/100)<=t);o+=1)r=s+o/100;for(var a=r,o=0;o<100&&!(this.cumulativeProbability(-r-o/1e4)<=t);o+=1)a=r+o/1e4;return-a},jss.TDistribution=TDistribution;var FDistribution=function(t,i){this.df1=t,this.df2=i,this.EPSILON=1e-10};FDistribution.prototype.L504=function(t,i,r,o){var a=t*i/(t*i+r),s=Math.sqrt(a),e=Math.log(s),n=Math.sqrt(1-a),u=Math.log(n),h=1-2*Math.atan(s/Math.sqrt(-s*s+1))/Math.PI,f=0;if(1!=r){M=Math.log(2*s/Math.PI);if(h-=Math.exp(M+u),3!=r)for(var b=Math.floor((r-3)/2),l=1;l<=b;l++){c=2*l+1;(v=(f+=Math.log((c-1)/c))+u*c+M)>-78.4&&(h-=Math.exp(v))}}if(1!=t){var M=f;if(r>1&&(M+=Math.log(r-1)),(M+=Math.log(2/Math.PI)+e+u*r)>-78.4&&(h+=Math.exp(M)),3!=t){b=Math.floor((t-3)/2);f=0;for(l=1;l<=b;l++){var c=2*l+1,v=(f+=Math.log((r+c-2)/c))+e*(c-1)+M;v>-78.4&&(h+=Math.exp(v))}}}return h},FDistribution.prototype.L401=function(t,i,r,o){var a=t*i/(t*i+r),s=Math.log(a),e=0,n=Math.log(1-a)*r/2;if(n>-78.4&&(e=Math.exp(n)),2!=t)for(var u=Math.floor(t/2-1),h=0,f=1;f<=u;f++){var b=2*f;(h+=Math.log(r+b-2)-Math.log(b)+s)+n>-78.4&&(e+=Math.exp(h+n))}return 1==o&&(e=1-e),e},FDistribution.prototype.ProbF=function(t,i,r){var o=r,a=t,s=i,e=0;if(2*Math.floor(a/2)==a)return n=this.L401(a,o,s,e);if(2*Math.floor(s/2)!=s){var n=this.L504(a,o,s,e);return n}return o=1/o,a=i,s=t,e=1,this.L401(a,o,s,e)},FDistribution.prototype.cumulativeProbability=function(t){if(this.df1>.01&this.df2>.01&t>this.EPSILON)return 1-this.ProbF(this.df1,this.df2,t);console.error("df1, df2, and F must be numbers greater than 0.")},jss.FDistribution=FDistribution;var ChiSquareDistribution=function(t){this.df=t};ChiSquareDistribution.prototype.ChiSquaredProbability=function(t){var i,r,o,a,s,e,n=0,u=this.df,h=Math.log(Math.sqrt(Math.PI)),f=1/Math.sqrt(Math.PI);if(t<=0||u<1)return 1;if(i=.5*t,even=parseInt(u/2*2,2)==u,u>1&&(n=Math.exp(-i)),r=even?n:2*new jssort.NormalDistribution(0,1).cumulativeProbability(-Math.sqrt(t)),u>2){if(t=.5*(u-1),s=even?1:.5,i>20){for(o=even?0:h,a=Math.log(i);s<=t;)e=a*s-i-(o=Math.log(s)+o),r+=Math.exp(e),s+=1;return r}for(o=even?1:f/Math.sqrt(i),a=0;s<=t;)a+=o*=i/s,s+=1;return a*n+r}return r},ChiSquareDistribution.prototype.cumulativeProbability=function(t){return 1-this.ChiSquaredProbability(t)},jss.ChiSquareDistribution=ChiSquareDistribution}(jssort),module&&(module.exports=jssort);